{"version":3,"file":"./dist/med.min.js","sources":["./dist/med.js"],"names":["window","Emitter","this","events","Caret","editor","Middleware","middleware","Data","id","modified","data","tmp","Observe","structure","HtmlBuilder","Editor","options","call","utils","mixin","Object","create","defaultOptions","context","el","document","createElement","setAttribute","classList","add","caret","bindEvents","handleEmpty","use","middlewares","init","module","exports","define","amd","Med","o1","o2","getOwnPropertyNames","forEach","name","desc","getOwnPropertyDescriptor","defineProperty","preventEvent","e","preventDefault","returnValue","os","userAgent","navigator","test","each","ctx","fn","length","Array","prototype","split","separator","limit","re","RegExp","replace","map","str","clone","obj","JSON","parse","stringify","equal","a","b","slice","sort","join","prop","hasOwnProperty","keyboard","modifiers",224,91,93,18,17,16,8,9,13,20,27,32,37,38,39,40,"super","next","event","code","keyCode","which","mod","modifier","ctrl","ctrlKey","option","alt","altKey","shift","shiftKey","command","meta","metaKey","key","node","focusNode","element","focusElement","nextElement","section","focusSection","paragraph","focusParagraph","paragraphs","focusParagraphs","detail","focusDetail","els","querySelectorAll","parentElement","removeChild","prevent","isEmpty","body","p","tagName","textContent","innerText","trim","currentSection","appendChild","insertBefore","nextSibling","moveToStart","renameElements","on","names","removeInlineStyle","removeExtraNodes","removeExtraNode","curr","prev","nodes","children","len","nodeType","TEXT_NODE","appendData","ELEMENT_NODE","innerHTML","parentNode","s","schema","toLowerCase","type","handleEmptyParagraph","createNewParagraph","shouldHandleThisEvent","textAfter","focusTo","h1","text","h2","h3","h4","h5","h6","blockquote","quoteTpye","figure","figureType","content","ol","ul","li","href","title","i","br","keys","tag","attrs","attrName","attr","args","attrType","push","handler","list","once","_once","off","splice","emit","arguments","apply","getSelection","toUpperCase","focusType","textBefore","selection","offset","focusOffset","substringData","focus","collapse","moveToEnd","range","createRange","selectNodeContents","removeAllRanges","addRange","parentIndex","indexOf","childNodes","setStart","setEnd","left","extractContents","save","rangeCount","getRangeAt","_range","restore","r","startContainer","startOffset","endContainer","endOffset","selectAllText","insertElement","deleteContents","insertNode","closestElement","Error","exec","cb","compose","fns","err","bind","set","val","get","_set","last","pop","undefined","update","toJSON","sync","sections","shouldBeDelete","scan","getAttribute","checkAndRemoveStrangeElement","genName","child","handleUnknownElement","getOffset","start","end","attribute","dataset","createTextNode","replaceChild","beforeHTML","beforeText","check","outerHTML","substr","d","json","rules","parentType","shouldRemove","fromJSON","importData","buildHTML","docfrag","createDocumentFragment","html","createElements","container","createSections","createParagraphs","createDetails","pointer","initElement","c","Math","random","v","toString","default","addEventListener","onKeydown","setTimeout","walk","first","remove","childContext"],"mappings":"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"}